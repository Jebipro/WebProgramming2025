<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>4x4 í¼ì¦ ê²Œì„</title>
<style>
body {
	font-family: 'Arial';
	text-align: center;
	background: #f5f5f5; /* í°íŠ¸ëŠ” Arialì„ ì‚¬ìš©í•˜ê³ , í…ìŠ¤íŠ¸ëŠ” ì¤‘ì•™ë°°ì¹˜, ë°°ê²½ìƒ‰ì€ #f5f5f5ë¡œ ì§€ì • */
}
#container {
	display: grid; /* ê·¸ë¦¬ë“œ í˜•ì‹ìœ¼ë¡œ ìƒì„±í•œë‹¤ */
	grid-template-columns: repeat(4, 100px); 
	grid-template-rows: repeat(4, 100px); /* ê·¸ë¦¬ë“œë¥¼ 4x4í˜•íƒœë¡œ ë‚˜ëˆˆë‹¤ */
	gap: 2px; /* í–‰ê³¼ ì—´ ì‚¬ì´ì˜ ê°„ê²©ì„ 2pxë¡œ ì§€ì • */
	justify-content: center; /* ì•„ì´í…œë“¤ì„ ì¤‘ì•™ì— ì •ë ¬ */
	margin: 20px auto; /* ì—¬ë°±ì€ ìƒí•˜20px, ì¢Œìš°ëŠ” ìë™ìœ¼ë¡œ ê· ë“±í•˜ê²Œ */
	width: 404px;
	height: 404px; /* ë„ˆë¹„ì™€ ë†’ì´ëŠ” 404pxë¡œ ì§€ì • */
}
.piece {
	width: 100px; 
	height: 100px; /* ë„ˆë¹„ì™€ ë†’ì´ë¥¼ 100pxë¡œ ì§€ì • */
	background-size: 400px 400px; /* ë°°ê²½ í¬ê¸°ë¥¼ 400 x 400ìœ¼ë¡œ ì§€ì • */
	cursor: grab; /* ì»¤ì„œ ëª¨ì–‘ì„ grabìœ¼ë¡œ ì§€ì • */
	border: 1px solid #ccc; /* í…Œë‘ë¦¬ë¥¼ 1px ì‹¤ì„  #cccë¡œ ì§€ì • */
}
#controls {
	margin-top: 15px; /* ì—¬ë°± ìƒë‹¨ 15px */
}
#timer {
	font-size: 20px;
	color: #333; /* í°íŠ¸ í¬ê¸° 20px, ìƒ‰ìƒì€ #333 */
	margin-top : 10px; /* ì—¬ë°± ìƒë‹¨ 10px */
}
</style>
</head>
<body>
<h2>4x4 í¼ì¦ ê²Œì„</h2>
<!-- í¼ì¦ ì¡°ê°ì´ ë“¤ì–´ê°ˆ ì»¨í…Œì´ë„ˆ -->
<div id="container"></div>
<!-- ë²„íŠ¼ê³¼ íƒ€ì´ë¨¸ë¥¼ ë¬¶ìŒ -->
<div id="controls">
	<button id="generateBtn">í¼ì¦ ìƒì„±</button>
	<button id="checkBtn">ì •ë‹µ í™•ì¸</button>
	<div id="timer">ë‚¨ì€ ì‹œê°„: 60ì´ˆ</div>
</div>

<script>
const container = document.getElementById('container');
const generateBtn = document.getElementById('generateBtn');
const checkBtn = document.getElementById('checkBtn');
const timerDisplay = document.getElementById('timer'); // id ì†ì„± ê°’ì„ í˜¸ì¶œ

const images = [
	"img/puzzle1.jpg",
	"img/puzzle2.jpg",
	"img/puzzle3.jpg",
	"img/puzzle4.jpg",
	"img/puzzle5.jpg" // jpg íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
];

let pieces = []; // í¼ì¦ ì¡°ê° ë°°ì—´
let timer; // íƒ€ì´ë¨¸
let timeLeft = 60; // ë‚¨ì€ ì‹œê°„ 60ì´ˆ
let correctOrder = []; // ì •ë‹µ ë°°ì—´
let selectedImage = ""; // ì„ íƒëœ ì´ë¯¸ì§€
let currentImageIndex = 0; // ìˆœì°¨ì ìœ¼ë¡œ ëŒë¦´ ì¸ë±ìŠ¤

// íƒ€ì´ë¨¸ í•¨ìˆ˜
function startTimer() {
	clearInterval(timer); // ì´ì „ íƒ€ì´ë¨¸ ì´ˆê¸°í™” 
	timeLeft = 60;
	timerDisplay.textContent = "ë‚¨ì€ ì‹œê°„: 60ì´ˆ"; // ë‚¨ì€ ì‹œê°„ í‘œì‹œ

	timer = setInterval(() => {
		timeLeft--; // ê°ì†Œ
		timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`; // ë³€ìˆ˜ ê°’ì„ ë¬¸ìì—´ ì•ˆì— ì‚½ì… (í…œí”Œë¦¿ ë¦¬í„°ëŸ´)
		if (timeLeft <= 0) {
			clearInterval(timer);
			alert("ì‹œê°„ ì´ˆê³¼! ğŸ˜¢ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”."); // ë‚¨ì€ ì‹œê°„ì´ 0ì´ˆê°€ ë˜ë©´ ê²½ê³ ì°½ì„ ë„ìš°ê³ , íƒ€ì´ë¨¸ ì¢…ë£Œ
		}
	}, 1000); // 1ì´ˆë§ˆë‹¤
}

// í¼ì¦ ìƒì„± í•¨ìˆ˜
function createPuzzle() {
	container.innerHTML = ""; // ê¸°ì¡´ í¼ì¦ì„ ì´ˆê¸°í™”
	pieces = [];
	correctOrder = [];

	// ìˆœì„œëŒ€ë¡œ ì´ë¯¸ì§€ ì„ íƒ
	selectedImage = images[currentImageIndex];
	currentImageIndex = (currentImageIndex + 1) % images.length;

	// í¼ì¦ ì¡°ê° ë§Œë“¤ê¸°
	for (let i = 0; i < 16; i++) { // 16ê°œì˜ í¼ì¦ ì¡°ê° ìƒì„±
		const piece = document.createElement("div"); // ìƒˆë¡œìš´ html div ìš”ì†Œ ìƒì„±
		piece.classList.add("piece"); // divì— css í´ë˜ìŠ¤ pieceë¥¼ ì¶”ê°€
		piece.style.backgroundImage = `url(${selectedImage})`; // ê° ì¡°ê°ì˜ ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ì„ íƒëœ í¼ì¦ ì´ë¯¸ì§€ë¡œ ì§€ì •
		const x = (i % 4) * -100; // ì¡°ê°ì´ ëª‡ ë²ˆì§¸ ì—´(column)ì¸ì§€ ê³„ì‚°
		const y = Math.floor(i / 4) * -100; // ì¡°ê°ì´ ëª‡ ë²ˆì§¸ í–‰(row)ì¸ì§€ ê³„ì‚°, ê° ì¡°ê° í¬ê¸°ê°€ 100pxì´ë¯€ë¡œ ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ì´ë™
		piece.style.backgroundPosition = `${x}px ${y}px`; // ë°°ê²½ ì´ë¯¸ì§€ ìœ„ì¹˜ë¥¼ ì¡°ê°ì— ë§ê²Œ ì„¤ì •
		piece.dataset.index = i; // HTML5 dataset ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê° ì›ë˜ ìœ„ì¹˜ ì €ì¥
		correctOrder.push(i); // correctOrder ë°°ì—´ì— ì¡°ê° ë²ˆí˜¸ ì¶”ê°€
		pieces.push(piece); // pieces ë°°ì—´ì— ìƒì„±í•œ div ì €ì¥
  	}

	// ì„ê¸°
	pieces.sort(() => Math.random() - 0.5); // í¼ì¦ ì¡°ê°ë“¤ì„ ë¬´ì‘ìœ„ ìˆœì„œë¡œ ì„ì–´ì„œ í™”ë©´ì— ë°°ì¹˜
	pieces.forEach(p => container.appendChild(p)); // ë°°ì—´ì„ ì„ì–´ì„œ ì»¨í…Œì´ë„ˆì— ì¶”ê°€

	addDragEvents(); // ë“œë˜ê·¸ ì´ë²¤íŠ¸ ë“±ë¡
	startTimer(); // íƒ€ì´ë¨¸ ì‹œì‘
}

// ë“œë˜ê·¸ ì´ë²¤íŠ¸
function addDragEvents() {
	let dragged = null; // dragged ë³€ìˆ˜ ì„ ì–¸ í›„ ì´ˆê¸°ê°’ì„ nullë¡œ ì„¤ì •

	<!-- í¼ì¦ ì¡°ê° ëª¨ë“  divì— ë°˜ë³µí•´ì„œ ì´ë²¤íŠ¸ ë“±ë¡ -->
	pieces.forEach(piece => {
		piece.draggable = true; // ë“œë˜ê·¸ ê°€ëŠ¥ ì—¬ë¶€ (trueë¡œ ì§€ì •)

		piece.addEventListener("dragstart", e => { // ì‚¬ìš©ìê°€ ì¡°ê°ì„ í´ë¦­í•˜ê³  ëŒê¸° ì‹œì‘í•  ë•Œ ì‹¤í–‰
			dragged = piece; // ì§€ê¸ˆ ë“œë˜ê·¸ ì¤‘ì¸ ì¡°ê°ì„ ê¸°ì–µ.
			e.dataTransfer.effectAllowed = "move"; // ë“œë˜ê·¸ íš¨ê³¼ë¥¼ ì´ë™ìœ¼ë¡œ ì§€ì •
			piece.style.opacity = "0.5"; // ë°˜íˆ¬ëª…ìœ¼ë¡œ ë§Œë“¤ì–´ ë“œë˜ê·¸ ì¤‘ì„ì„ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œ
		});

		piece.addEventListener("dragend", e => { // ë“œë˜ê·¸ê°€ ëë‚˜ë©´ íˆ¬ëª…ë„ë¥¼ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¼
			piece.style.opacity = "1";
		});
		// ë“œë˜ê·¸í•œ ìš”ì†Œê°€ ë‹¤ë¥¸ ì¡°ê° ìœ„ì— ì˜¬ë¼ê°€ ìˆì„ ë•Œ í•„ìˆ˜ ì´ë²¤íŠ¸
		piece.addEventListener("dragover", e => e.preventDefault()); // ë¸Œë¼ìš°ì € ê¸°ë³¸ ë™ì‘ ë°©ì§€

		piece.addEventListener("drop", e => { // ë“œë˜ê·¸í•œ ì¡°ê°ì„ ë‹¤ë¥¸ ì¡°ê° ìœ„ì— ë†“ì„ ë•Œ ì‹¤í–‰
			e.preventDefault();
			if (dragged === piece) return;

			// ë‘ ìš”ì†Œì˜ ì‹¤ì œ ìœ„ì¹˜ë¥¼ êµí™˜ (DOM swap)
			const draggedNext = dragged.nextSibling;
			const pieceNext = piece.nextSibling; // dragì™€ dropëœ ë‘ ì¡°ê°ì˜ nextSiblingì„ ì´ìš©í•´ ìœ„ì¹˜ë¥¼ êµí™˜
			const parent = piece.parentNode; // pieceì˜ ë¶€ëª¨ ìš”ì†Œë¥¼ ê°€ì ¸ì˜´(#container)

			if (draggedNext === piece) { // ë‘ ì¡°ê°ì´ ë°”ë¡œ ë¶™ì–´ ìˆëŠ” ê²½ìš°
				parent.insertBefore(piece, dragged); // ìˆœì„œ ë³€ê²½
			} else if (pieceNext === dragged) { // ë°˜ëŒ€ ìˆœì„œì¸ ê²½ìš°
				parent.insertBefore(dragged, piece); // ìˆœì„œë¥¼ ë’¤ì§‘ì–´ë„ ë˜ëŠ” ìƒí™© ì²˜ë¦¬
			} else { // ì¼ë°˜ì ì¸ ë–¨ì–´ì§„ ê²½ìš°
				parent.insertBefore(dragged, pieceNext); // ë¨¼ì € ë“œë˜ê·¸ ì¡°ê°ì„ ë“œë¡­ ëŒ€ìƒ ë‹¤ìŒì— ì‚½ì…
				parent.insertBefore(piece, draggedNext); // ì´í›„ ë“œë¡­ ëŒ€ìƒ ì¡°ê°ì„ ì›ë˜ ë“œë˜ê·¸ ì¡°ê° ìœ„ì¹˜ì— ì‚½ì…
			}

			// pieces ë°°ì—´ë„ êµì²´
			const draggedIndex = pieces.indexOf(dragged);
			const targetIndex = pieces.indexOf(piece); // í™”ë©´ì— ë³´ì´ëŠ” DOMë§Œ ë°”ë€ŒëŠ” ê²Œ ì•„ë‹ˆë¼ JS ë°°ì—´ë„ êµí™˜
			[pieces[draggedIndex], pieces[targetIndex]] = [pieces[targetIndex], pieces[draggedIndex]];
		});
	});
}

// ì •ë‹µ ì²´í¬
checkBtn.addEventListener("click", () => {
	const current = pieces.map(p => parseInt(p.dataset.index)); // í˜„ì¬ í¼ì¦ ì¡°ê°ì˜ ìˆœì„œ ë°°ì—´ì„ ë§Œë“¦
	const isCorrect = current.every((v, i) => v === correctOrder[i]); // í˜„ì¬ ë°°ì—´ê³¼ ì •ë‹µ ë°°ì—´ì„ ë¹„êµ every() ë°°ì—´ì˜ ëª¨ë“  ìš”ì†Œê°€ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸
	if (isCorrect) {
		clearInterval(timer);
		alert("ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! ì¶•í•˜í•´ìš”!"); // ì •ë‹µì´ë©´ ì‹œê°„ ì¤‘ì§€ í›„ ì •ë‹µ ì¶œë ¥
	} else {
		alert("âŒ ì•„ì§ ë§ì¶”ì§€ ëª»í–ˆì–´ìš”!"); // ì˜¤ë‹µì´ë©´ í‹€ë ¸ë‹¤ëŠ” ë¬¸êµ¬ ì¶œë ¥
	}
});
// ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
generateBtn.addEventListener("click", createPuzzle); // ìƒì„± ë²„íŠ¼ í´ë¦­ ì‹œ í¼ì¦ ìƒì„±
</script>
</body>
</html>