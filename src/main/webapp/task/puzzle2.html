<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>4x4 í¼ì¦ ê²Œì„</title>
<style>
body {
    font-family: 'Arial';
    text-align: center;
    background: #f5f5f5;
}
#container {
    display: table; /* grid ëŒ€ì‹  tableë¡œ ë°°ì¹˜ */
    margin: 20px auto;
}
.row {
    display: table-row;
}
.piece {
    display: table-cell;
    width: 100px;
    height: 100px;
    background-size: 400px 400px;
    border: 1px solid #ccc;
    text-align: center;
    vertical-align: middle;
    cursor: move;
}
#controls {
    margin-top: 15px;
}
#timer {
    font-size: 20px;
    color: #333;
    margin-top: 10px;
}
</style>
</head>
<body>
<h2>4x4 í¼ì¦ ê²Œì„</h2>
<div id="container"></div>

<div id="controls">
    <button id="generateBtn">í¼ì¦ ìƒì„±</button>
    <button id="checkBtn">ì •ë‹µ í™•ì¸</button>
    <div id="timer">ë‚¨ì€ ì‹œê°„: 60ì´ˆ</div>
</div>

<script>
// ìƒìˆ˜ë¡œ ì„ ì–¸: ì¬í• ë‹¹í•˜ì§€ ì•ŠìŒ
const container = document.getElementById('container');
const generateBtn = document.getElementById('generateBtn');
const checkBtn = document.getElementById('checkBtn');
const timerDisplay = document.getElementById('timer');
const images = [
    "img/puzzle1.jpg",
    "img/puzzle2.jpg",
    "img/puzzle3.jpg",
    "img/puzzle4.jpg",
    "img/puzzle5.jpg"
];

// ì¬í• ë‹¹ ê°€ëŠ¥í•œ ë³€ìˆ˜
let pieces = [];
let timer;
let timeLeft = 60;
let correctOrder = [];
let selectedImage = "";
let currentImageIndex = 0;
let dragged = null;

function startTimer() {
    clearInterval(timer);
    timeLeft = 60;
    timerDisplay.innerHTML = "ë‚¨ì€ ì‹œê°„: 60ì´ˆ";
    timer = setInterval(function(){
        timeLeft--;
        timerDisplay.innerHTML = "ë‚¨ì€ ì‹œê°„: " + timeLeft + "ì´ˆ";
        if(timeLeft <= 0){
            clearInterval(timer);
            alert("ì‹œê°„ ì´ˆê³¼! ğŸ˜¢ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.");
        }
    }, 1000);
}

function createPuzzle() {
    container.innerHTML = "";
    pieces = [];
    correctOrder = [];

    // ìˆœì„œëŒ€ë¡œ ì´ë¯¸ì§€ ì„ íƒ
    selectedImage = images[currentImageIndex];
    currentImageIndex = (currentImageIndex + 1) % images.length;

    // 4x4 í…Œì´ë¸” í˜•íƒœë¡œ ì¡°ê° ìƒì„±
    for(let row=0; row<4; row++){
        const tr = document.createElement("div");
        tr.className = "row";
        for(let col=0; col<4; col++){
            const i = row*4 + col;
            const td = document.createElement("div");
            td.className = "piece";
            td.style.backgroundImage = "url("+selectedImage+")";
            td.style.backgroundPosition = (-col*100) + "px " + (-row*100) + "px";
            td.setAttribute("data-index", i); // ì›ë˜ ìœ„ì¹˜ ì €ì¥
            correctOrder.push(i);
            tr.appendChild(td);
            pieces.push(td);
        }
        container.appendChild(tr);
    }

    // ì„ê¸° (ë°°ê²½ ìœ„ì¹˜ì™€ data-index ì„ê¸°)
    for(let k=0; k<pieces.length; k++){
        const swapIndex = Math.floor(Math.random()*pieces.length);
        const tmpBg = pieces[k].style.backgroundPosition;
        pieces[k].style.backgroundPosition = pieces[swapIndex].style.backgroundPosition;
        pieces[swapIndex].style.backgroundPosition = tmpBg;

        const tmpIndex = pieces[k].getAttribute("data-index");
        pieces[k].setAttribute("data-index", pieces[swapIndex].getAttribute("data-index"));
        pieces[swapIndex].setAttribute("data-index", tmpIndex);
    }

    addDragEvents();
    startTimer();
}

function addDragEvents(){
    for(let i=0; i<pieces.length; i++){
        const piece = pieces[i];

        piece.ondragstart = function(e){
            dragged = this;
        };
        piece.ondragover = function(e){
            e.preventDefault();
        };
        piece.ondrop = function(e){
            e.preventDefault();
            if(dragged === this) return;

            // ë°°ê²½ ìœ„ì¹˜ì™€ data-index êµí™˜
            const tmpBg = this.style.backgroundPosition;
            this.style.backgroundPosition = dragged.style.backgroundPosition;
            dragged.style.backgroundPosition = tmpBg;

            const tmpIndex = this.getAttribute("data-index");
            this.setAttribute("data-index", dragged.getAttribute("data-index"));
            dragged.setAttribute("data-index", tmpIndex);
        };
    }
}

checkBtn.onclick = function(){
    let correct = true;
    for(let i=0; i<pieces.length; i++){
        if(parseInt(pieces[i].getAttribute("data-index")) !== correctOrder[i]){
            correct = false;
            break;
        }
    }
    if(correct){
        clearInterval(timer);
        alert("ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! ì¶•í•˜í•´ìš”!");
    }else{
        alert("âŒ ì•„ì§ ë§ì¶”ì§€ ëª»í–ˆì–´ìš”!");
    }
};

generateBtn.onclick = createPuzzle;
</script>
</body>
</html>